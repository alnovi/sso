import{r as c,m as C,o as L,c as k,u as a,d as J,a as X,b as Z,l as ee,_ as oe,e as te,f as x,w as e,g as o,h as ne,i as ae,n as se,j as le,k as V,p as U,t as re,B as N,N as S,S as ue,M as pe,q as ie,s as R,v as O,x as H,y as B,z as M,A as $,C as A,D,E as ce,F as E,G as de,H as _e}from"./utils-CxQ2_0qZ.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as F,c as me,a as fe,b as ve}from"./vue-router-SHaqimmA.js";import{u as W,U as Y,n as I,a as G}from"./notify-2uhNS4a7.js";import{P as j}from"./Password-BQM-QoZP.js";const ge=["src"],we={__name:"App",setup(P){const d=c({icon:C("client-icon","/public/app.png"),name:C("client-name","Приложение")}),r=c(!1),_=c(null),i=()=>{r.value=!r.value,localStorage.setItem("theme-is-dark",r.value?"true":"false"),f()},f=()=>{r.value?_.value=Z:_.value=ee};return L(()=>{r.value=localStorage.getItem("theme-is-dark")==="true",f()}),(l,s)=>{const p=V,w=S,u=N,t=le,n=te("router-view"),v=ie,g=ae,h=ne,y=oe;return x(),k(y,{theme:_.value,locale:a(X),"date-locale":a(J)},{default:e(()=>[o(h,null,{default:e(()=>[o(g,{position:"absolute",class:se(["main-layout",r.value?"dark":"light"])},{default:e(()=>[o(t,null,{default:e(()=>[o(p,{justify:"space-between",align:"center"},{default:e(()=>[o(p,{align:"center"},{default:e(()=>[U("img",{src:d.value.icon,width:"30px",height:"30px",alt:""},null,8,ge),U("h2",null,re(d.value.name),1)]),_:1}),o(p,{align:"center"},{default:e(()=>[r.value?(x(),k(u,{key:0,tertiary:"",circle:"",onClick:i},{icon:e(()=>[o(w,{size:"22",component:a(ue)},null,8,["component"])]),_:1})):(x(),k(u,{key:1,tertiary:"",circle:"",onClick:i},{icon:e(()=>[o(w,{size:"22",component:a(pe)},null,8,["component"])]),_:1}))]),_:1})]),_:1})]),_:1}),o(v,{style:{padding:"24px"}},{default:e(()=>[o(p,{align:"center",justify:"center",style:{height:"100%"}},{default:e(()=>[o(n)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},8,["theme","locale","date-locale"])}}},he=q(we,[["__scopeId","data-v-4df1ca1a"]]),ye={__name:"Authorize",setup(P){const d=W(R("VITE_API_HOST","/")),r=C("auth-query",R("VITE_AUTH_QUERY")),_=F(),i=O(),f=c(null),l=c({login:"",password:"",remember:!1}),s=c({login:null,password:null}),p=()=>l.value.login.length<5||l.value.password.length<5;async function w(){s.value.login=null,s.value.password=null;const u={login:l.value.login,password:l.value.password,remember:l.value.remember};d.post(`oauth/authorize?${r}`,u).then(t=>{window.location.replace(t.data.url)}).catch(t=>{if(t.code==="ERR_NETWORK"){i.error(I("Сервер не доступен"));return}t.response.data&&t.response.data.error&&i.error(I(t.response.data.error)),t.response.status===422&&(s.value=t.response.data.validate)})}return(u,t)=>{const n=S,v=D,g=M,h=ce,y=B,b=N,T=V,z=H;return x(),k(z,{title:"Авторизация",bordered:"",segmented:{content:!0,footer:"soft"}},{footer:e(()=>[o(T,{justify:"space-between"},{default:e(()=>[o(b,{text:"",onClick:t[3]||(t[3]=m=>a(_).push(`/oauth/forgot-password?${a(r)}`))},{default:e(()=>t[4]||(t[4]=[E("Забыли свой пароль?")])),_:1}),o(b,{onClick:w,disabled:p(),size:"large",type:"primary",style:{width:"150px"}},{default:e(()=>t[5]||(t[5]=[E(" Войти ")])),_:1},8,["disabled"])]),_:1})]),default:e(()=>[o(y,{ref:f.value,"label-width":80,model:l.value},{default:e(()=>[o(g,{label:"Логин",path:"login",required:"",feedback:a(A)(s.value.login,"login","логин"),"validation-status":a($)(s.value.login)},{default:e(()=>[o(v,{size:"large",value:l.value.login,"onUpdate:value":t[0]||(t[0]=m=>l.value.login=m),type:"text",placeholder:"Логин"},{prefix:e(()=>[o(n,{component:a(Y)},null,8,["component"])]),_:1},8,["value"])]),_:1},8,["feedback","validation-status"]),o(g,{label:"Пароль",path:"password",required:"",feedback:a(A)(s.value.password,"password","пароль"),"validation-status":a($)(s.value.password)},{default:e(()=>[o(v,{size:"large",value:l.value.password,"onUpdate:value":t[1]||(t[1]=m=>l.value.password=m),type:"password","show-password-on":"mousedown",placeholder:"Пароль"},{prefix:e(()=>[o(n,{component:a(j)},null,8,["component"])]),_:1},8,["value"])]),_:1},8,["feedback","validation-status"]),U("div",null,[o(h,{size:"large",label:"Не выходить",checked:l.value.remember,"onUpdate:checked":t[2]||(t[2]=m=>l.value.remember=m)},null,8,["checked"])])]),_:1},8,["model"])]),_:1})}}},Q=q(ye,[["__scopeId","data-v-f9cb804d"]]),be={__name:"ForgotPassword",setup(P){const d=W(R("VITE_API_HOST","/")),r=C("auth-query",R("VITE_AUTH_QUERY")),_=F(),i=O(),f=c(null),l=c({login:""}),s=c({login:null}),p=()=>l.value.login.length<5;async function w(){s.value.login=null,d.post(`/oauth/forgot-password?${r}`,l.value).then(u=>{l.value.login="",i.success(G("Ссылка для смены пароля отправлена на почту"))}).catch(u=>{if(u.code==="ERR_NETWORK"){i.error(I("Сервер не доступен"));return}u.response.data&&u.response.data.error&&i.error(I(u.response.data.error)),u.response.status===422&&(s.value=u.response.data.validate)})}return(u,t)=>{const n=S,v=D,g=M,h=B,y=N,b=V,T=H;return x(),k(T,{title:"Восстановление доступа",bordered:"",segmented:{content:!0,footer:"soft"}},{footer:e(()=>[o(b,{justify:"space-between"},{default:e(()=>[o(y,{text:"",onClick:t[1]||(t[1]=z=>a(_).push(`/oauth/authorize?${a(r)}`))},{default:e(()=>t[2]||(t[2]=[E("У меня есть пароль")])),_:1}),o(y,{onClick:w,disabled:p(),size:"large",type:"primary",style:{width:"150px"}},{default:e(()=>t[3]||(t[3]=[E(" Восстановить ")])),_:1},8,["disabled"])]),_:1})]),default:e(()=>[o(h,{ref:f.value,"label-width":80,model:l.value},{default:e(()=>[o(g,{label:"Логин",path:"login",required:"",feedback:a(A)(s.value.login,"login","логин"),"validation-status":a($)(s.value.login)},{default:e(()=>[o(v,{size:"large",value:l.value.login,"onUpdate:value":t[0]||(t[0]=z=>l.value.login=z),type:"text",placeholder:"Логин"},{prefix:e(()=>[o(n,{component:a(Y)},null,8,["component"])]),_:1},8,["value"])]),_:1},8,["feedback","validation-status"])]),_:1},8,["model"])]),_:1})}}},ke=q(be,[["__scopeId","data-v-6fc04484"]]),xe={__name:"ResetPassword",setup(P){const d=W(R("VITE_API_HOST","/")),r=C("auth-query",R("VITE_AUTH_QUERY")),_=new URLSearchParams(window.location.search).get("hash"),i=F(),f=O(),l=c(null),s=c({password:"",passwordConfirmation:""}),p=c({password:null}),w=()=>s.value.password.length>=5&&s.value.password===s.value.passwordConfirmation;async function u(){p.value.password=null;const t={token:_,password:s.value.password};d.post("oauth/reset-password",t).then(n=>{f.success(G("Пароль успешно изменен")),i.push(`/oauth/authorize?${r}`)}).catch(n=>{if(n.code==="ERR_NETWORK"){f.error(I("Сервер не доступен"));return}n.response.data&&n.response.data.error&&f.error(I(n.response.data.error)),n.response.status===422&&(p.value=n.response.data.validate)})}return(t,n)=>{const v=S,g=D,h=M,y=B,b=N,T=V,z=H;return x(),k(z,{title:"Смена пароля",bordered:"",segmented:{content:!0,footer:"soft"}},{footer:e(()=>[o(T,{justify:"space-between"},{default:e(()=>[o(b,{text:"",onClick:n[2]||(n[2]=m=>a(i).push(`/oauth/authorize?${a(r)}`))},{default:e(()=>n[3]||(n[3]=[E("Войти с паролем")])),_:1}),o(b,{onClick:u,disabled:!w(),size:"large",type:"primary",style:{width:"150px"}},{default:e(()=>n[4]||(n[4]=[E(" Сохранить ")])),_:1},8,["disabled"])]),_:1})]),default:e(()=>[o(y,{ref:l.value,"label-width":80,model:s.value},{default:e(()=>[o(h,{label:"Новый пароль",path:"password",required:"",feedback:a(A)(p.value.password,"password","пароль"),"validation-status":a($)(p.value.password)},{default:e(()=>[o(g,{size:"large",value:s.value.password,"onUpdate:value":n[0]||(n[0]=m=>s.value.password=m),type:"password","show-password-on":"mousedown",placeholder:"Новый пароль"},{prefix:e(()=>[o(v,{component:a(j)},null,8,["component"])]),_:1},8,["value"])]),_:1},8,["feedback","validation-status"]),o(h,{label:"Повторите пароль",path:"password",required:"",feedback:a(A)(p.value.password,"password","пароль"),"validation-status":a($)(p.value.password)},{default:e(()=>[o(g,{size:"large",value:s.value.passwordConfirmation,"onUpdate:value":n[1]||(n[1]=m=>s.value.passwordConfirmation=m),type:"password","show-password-on":"mousedown",placeholder:"Повторите пароль"},{prefix:e(()=>[o(v,{component:a(j)},null,8,["component"])]),_:1},8,["value"])]),_:1},8,["feedback","validation-status"])]),_:1},8,["model"])]),_:1})}}},Re=q(xe,[["__scopeId","data-v-39785fb6"]]),ze={};function Ee(P,d){const r=V,_=H;return x(),k(_,{bordered:"",segmented:{content:!0,footer:"soft"}},{default:e(()=>[o(r,{vertical:"",align:"center",justify:"center",style:{height:"100%"}},{default:e(()=>d[0]||(d[0]=[U("div",{class:"err_code"},"404",-1),U("div",{class:"err_message"},"Страница не найдена",-1)])),_:1})]),_:1})}const Ie=q(ze,[["render",Ee],["__scopeId","data-v-a0375c1e"]]),Te=me({history:R("PROD")?fe():ve(),routes:[{path:"/",component:Q},{path:"/oauth/authorize",name:"authorize",component:Q},{path:"/oauth/forgot-password",name:"forgot-password",component:ke},{path:"/oauth/reset-password",name:"reset-password",component:Re},{path:"/:pathMatch(.*)*",component:Ie}]}),K=de(he);K.use(_e);K.use(Te);K.mount("#app");
