import{I as N,J as w,f as u,p as o,s as M,v as O,r as g,K as P,g as e,w as s,z as U,u as i,A as C,C as E,D as L,N as D,y as Y,B as H,F as V,k as A,L as q,O as j,t as z,P as F,Q,c as T,R as G,T as J,U as Z,o as X,V as ee,h as oe,i as te,j as se,S as ne,M as ae,q as le,d as ie,a as re,_ as _e,b as ce,l as de,G as ue,H as pe}from"./utils-CxQ2_0qZ.js";import{u as R,n as I,U as me,a as K}from"./notify-2uhNS4a7.js";import{h as B,L as ve}from"./moment-BXwSVSMG.js";import{P as S}from"./Password-BQM-QoZP.js";const fe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},we=N({name:"Email",render:function(m,a){return u(),w("svg",fe,a[0]||(a[0]=[o("path",{d:"M28 6H4a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zm-2.2 2L16 14.78L6.2 8zM4 24V8.91l11.43 7.91a1 1 0 0 0 1.14 0L28 8.91V24z",fill:"currentColor"},null,-1)]))}}),he={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},ge=N({name:"Laptop",render:function(m,a){return u(),w("svg",he,a[0]||(a[0]=[o("path",{d:"M26 24.005H6a2.002 2.002 0 0 1-2-2v-14a2.002 2.002 0 0 1 2-2h20a2.002 2.002 0 0 1 2 2v14a2.003 2.003 0 0 1-2 2zm-20-16v14h20v-14z",fill:"currentColor"},null,-1),o("path",{d:"M2 26.005h28v2H2z",fill:"currentColor"},null,-1)]))}}),ke={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},ye=N({name:"TrashCan",render:function(m,a){return u(),w("svg",ke,a[0]||(a[0]=[o("path",{d:"M12 12h2v12h-2z",fill:"currentColor"},null,-1),o("path",{d:"M18 12h2v12h-2z",fill:"currentColor"},null,-1),o("path",{d:"M4 6v2h2v20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8h2V6zm4 22V8h16v20z",fill:"currentColor"},null,-1),o("path",{d:"M12 2h8v2h-8z",fill:"currentColor"},null,-1)]))}}),be="/assets/sso-1rZUkQeo.png",xe={class:"block-layout"},$e={class:"block-layout-content"},ze={__name:"Profile",setup(k){const m=R(M("VITE_API_HOST","/")),a=O(),t=g({name:"",email:""}),n=g({name:"",email:""}),_=()=>{n.value.name="",n.value.email=""},p=()=>t.value.name.length<3||t.value.email.length<5,f=()=>{_(),m.put("/profile/me",t.value).then(r=>{a.success(K("Данные успешно изменены"))}).catch(r=>{r.code==="ERR_NETWORK"&&a.error(I("Сервер не доступен")),r.response.data&&r.response.data.error&&a.error(I(r.response.data.error)),r.response.status===422&&(n.value=r.response.data.validate)})};return P(()=>{m.get("/profile/me").then(r=>{t.value.name=r.data.name,t.value.email=r.data.email}).catch(r=>{r.code==="ERR_NETWORK"&&a.error(I("Сервер не доступен"))})}),(r,c)=>{const l=D,v=L,d=U,h=Y,x=H,$=A;return u(),w("div",xe,[c[3]||(c[3]=o("div",{class:"block-layout-header"},[o("div",{class:"block-layout-header__title"},"Мой профиль"),o("div",{class:"separator"}),o("div",{class:"block-layout-header__description"},"Управление личной информацией.")],-1)),o("div",$e,[e(h,null,{default:s(()=>[e(d,{label:"Имя",path:"name",required:"",feedback:i(E)(n.value.name,"name","имя"),"validation-status":i(C)(n.value.name)},{default:s(()=>[e(v,{size:"large",value:t.value.name,"onUpdate:value":c[0]||(c[0]=y=>t.value.name=y),type:"text",placeholder:"Имя"},{prefix:s(()=>[e(l,{component:i(me)},null,8,["component"])]),_:1},8,["value"])]),_:1},8,["feedback","validation-status"]),e(d,{label:"Email",path:"email",required:"",feedback:i(E)(n.value.email,"email","email"),"validation-status":i(C)(n.value.email)},{default:s(()=>[e(v,{size:"large",value:t.value.email,"onUpdate:value":c[1]||(c[1]=y=>t.value.email=y),type:"text",placeholder:"Email"},{prefix:s(()=>[e(l,{component:i(we)},null,8,["component"])]),_:1},8,["value"])]),_:1},8,["feedback","validation-status"])]),_:1}),e($,{justify:"end"},{default:s(()=>[e(x,{onClick:f,disabled:p(),size:"large",type:"primary",style:{width:"150px"}},{default:s(()=>c[2]||(c[2]=[V(" Изменить ")])),_:1},8,["disabled"])]),_:1})])])}}},Ce={class:"block-layout"},Ee={class:"block-layout-content"},Te={class:"app-list"},Ie={class:"app-list-item__logo"},Me=["src"],Re={class:"app-list-item__title"},Ve={__name:"Applications",setup(k){const m=R(M("VITE_API_HOST","/")),a=g([]),t=n=>{window.open(`/oauth/authorize?response_type=code&client_id=${n.id}&redirect_uri=${n.callback}`,"_blank")};return P(()=>{m.get("/profile/clients").then(n=>{a.value=n.data})}),(n,_)=>{const p=F;return u(),w("div",Ce,[_[0]||(_[0]=o("div",{class:"block-layout-header"},[o("div",{class:"block-layout-header__title"},"Приложения"),o("div",{class:"separator"}),o("div",{class:"block-layout-header__description"},"Список доступных приложений.")],-1)),o("div",Ee,[o("div",Te,[(u(!0),w(q,null,j(a.value,(f,r)=>(u(),w("div",{class:"app-list-container",key:r},[e(p,{class:"app-list-item",onClick:c=>t(f)},{default:s(()=>[o("div",Ie,[o("img",{src:f.icon||"/public/app.png",width:"50",height:"50",alt:""},null,8,Me)]),o("div",Re,z(f.name),1)]),_:2},1032,["onClick"])]))),128))])])])}}},De={class:"block-layout"},He={class:"block-layout-content"},Se={class:"session-list"},Ne={class:"session-list-item__logo"},Pe={class:"session-list-item__content"},Ae={class:"session-list-item__title"},Be={class:"session-list-item__description"},Oe={class:"session-list-item__action"},Ue={__name:"Sessions",setup(k){const m=Q(),a=R(M("VITE_API_HOST","/")),t=g([]),n=_=>{m.warning({title:"Внимание",content:`Удалить сессию ${_.app} от ${B(_.created_at).format("DD.MM.YYYY HH:mm:ss")}?`,positiveText:"Удалить",negativeText:"Отмена",draggable:!0,onPositiveClick:()=>{a.delete(`/profile/sessions/${_.id}`).then(()=>{_.is_current?window.location.reload():t.value=t.value.filter(p=>p.id!==_.id)})}})};return P(()=>{a.get("/profile/sessions").then(_=>{t.value=_.data})}),(_,p)=>{const f=D,r=G,c=Z,l=H,v=F;return u(),w("div",De,[p[1]||(p[1]=o("div",{class:"block-layout-header"},[o("div",{class:"block-layout-header__title"},"Устройства"),o("div",{class:"separator"}),o("div",{class:"block-layout-header__description"},"Список активных сеансов.")],-1)),o("div",He,[o("div",Se,[(u(!0),w(q,null,j(t.value,(d,h)=>(u(),T(v,{class:"session-list-item",key:h},{default:s(()=>[o("div",Ne,[e(r,{size:40,"border-radius":20},{default:s(()=>[e(f,{size:30},{default:s(()=>[e(i(ge))]),_:1})]),_:1})]),o("div",Pe,[o("div",Ae,[V(z(d.app)+" ("+z(d.os)+") ",1),d.is_current?(u(),T(c,{key:0,type:"success",size:"small"},{default:s(()=>p[0]||(p[0]=[V("это устройство")])),_:1})):J("",!0)]),o("div",Be," IP: "+z(d.ip)+" | Дата: "+z(i(B)(d.created_at).format("DD.MM.YYYY HH:mm:ss")),1)]),o("div",Oe,[e(l,{strong:"",secondary:"",circle:"",type:"error",onClick:x=>n(d)},{icon:s(()=>[e(f,null,{default:s(()=>[e(i(ye))]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024))),128))])])])}}},Le={class:"block-layout"},Ye={class:"block-layout-content"},qe={__name:"Secure",setup(k){const m=R(M("VITE_API_HOST","/")),a=O(),t=g({old_password:"",new_password:"",confirm_password:""}),n=g({old_password:"",new_password:"",confirm_password:""}),_=()=>{t.value.old_password="",t.value.new_password="",t.value.confirm_password=""},p=()=>{n.value.old_password="",n.value.new_password="",n.value.confirm_password=""},f=()=>t.value.old_password.length<5||t.value.new_password.length<5||t.value.confirm_password.length<5,r=()=>{if(p(),t.value.new_password!==t.value.confirm_password)return n.value.new_password="пароли не совпадают",n.value.confirm_password="пароли не совпадают",!1;const c={old_password:t.value.old_password,new_password:t.value.new_password};m.put("/profile/password",c).then(()=>{_(),a.success(K("Пароль успешно изменен"))}).catch(l=>{l.code==="ERR_NETWORK"&&a.error(I("Сервер не доступен")),l.response.data&&l.response.data.error&&a.error(I(l.response.data.error)),l.response.status===422&&(n.value=l.response.data.validate)})};return(c,l)=>{const v=D,d=L,h=U,x=Y,$=H,y=A;return u(),w("div",Le,[l[4]||(l[4]=o("div",{class:"block-layout-header"},[o("div",{class:"block-layout-header__title"},"Безопасность"),o("div",{class:"separator"}),o("div",{class:"block-layout-header__description"},"Изменение пароля доступа.")],-1)),o("div",Ye,[e(x,null,{default:s(()=>[e(h,{label:"Текущий пароль",path:"password",required:"",feedback:i(E)(n.value.old_password,"old_password","пароль"),"validation-status":i(C)(n.value.old_password)},{default:s(()=>[e(d,{size:"large",value:t.value.old_password,"onUpdate:value":l[0]||(l[0]=b=>t.value.old_password=b),type:"password","show-password-on":"mousedown",placeholder:"Текущий пароль"},{prefix:s(()=>[e(v,{component:i(S)},null,8,["component"])]),_:1},8,["value"])]),_:1},8,["feedback","validation-status"]),e(h,{label:"Новый пароль",path:"new_password",required:"",feedback:i(E)(n.value.new_password,"new_password","пароль"),"validation-status":i(C)(n.value.new_password)},{default:s(()=>[e(d,{size:"large",value:t.value.new_password,"onUpdate:value":l[1]||(l[1]=b=>t.value.new_password=b),type:"password","show-password-on":"mousedown",placeholder:"Новый пароль"},{prefix:s(()=>[e(v,{component:i(S)},null,8,["component"])]),_:1},8,["value"])]),_:1},8,["feedback","validation-status"]),e(h,{label:"Повторите пароль",path:"confirm_password",required:"",feedback:i(E)(n.value.confirm_password,"confirm_password","пароль"),"validation-status":i(C)(n.value.confirm_password)},{default:s(()=>[e(d,{size:"large",value:t.value.confirm_password,"onUpdate:value":l[2]||(l[2]=b=>t.value.confirm_password=b),type:"password","show-password-on":"mousedown",placeholder:"Повторите пароль"},{prefix:s(()=>[e(v,{component:i(S)},null,8,["component"])]),_:1},8,["value"])]),_:1},8,["feedback","validation-status"])]),_:1}),e(y,{justify:"end"},{default:s(()=>[e($,{onClick:r,disabled:f(),size:"large",type:"primary",style:{width:"150px"}},{default:s(()=>l[3]||(l[3]=[V(" Изменить ")])),_:1},8,["disabled"])]),_:1})])])}}},je={class:"manu-layout"},Fe={__name:"App",setup(k){const m=R(M("VITE_API_HOST","/")),a=g(!1),t=g(null),n=()=>{a.value=!a.value,localStorage.setItem("theme-is-dark",a.value?"true":"false"),_()},_=()=>{a.value?t.value=ce:t.value=de},p=()=>{m.post("/profile/logout",null).finally(()=>{window.location.reload()})};return X(()=>{a.value=localStorage.getItem("theme-is-dark")==="true",_()}),(f,r)=>{const c=A,l=D,v=H,d=se,h=le,x=te,$=oe,y=ee,b=_e;return u(),T(b,{theme:t.value,locale:i(re),"date-locale":i(ie)},{default:s(()=>[e(y,null,{default:s(()=>[e($,null,{default:s(()=>[e(x,{style:{height:"100vh"},"native-scrollbar":!1},{default:s(()=>[e(d,{bordered:""},{default:s(()=>[o("div",je,[e(c,{justify:"space-between",align:"center"},{default:s(()=>[e(c,{align:"center"},{default:s(()=>r[0]||(r[0]=[o("img",{src:be,width:"40px",height:"40px",alt:""},null,-1),o("h1",null,"Единый вход",-1)])),_:1}),e(c,{align:"center"},{default:s(()=>[a.value?(u(),T(v,{key:0,tertiary:"",circle:"",onClick:n},{icon:s(()=>[e(l,{size:"22",component:i(ne)},null,8,["component"])]),_:1})):(u(),T(v,{key:1,tertiary:"",circle:"",onClick:n},{icon:s(()=>[e(l,{size:"22",component:i(ae)},null,8,["component"])]),_:1})),e(v,{tertiary:"",circle:"",onClick:p},{icon:s(()=>[e(l,{size:"22",component:i(ve)},null,8,["component"])]),_:1})]),_:1})]),_:1})])]),_:1}),e(h,{style:{padding:"24px"}},{default:s(()=>[e(ze),e(Ve),e(Ue),e(qe)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["theme","locale","date-locale"])}}},W=ue(Fe);W.use(pe);W.mount("#app");
